"use strict";(self.webpackChunkgraphile_worker=self.webpackChunkgraphile_worker||[]).push([[9174],{9916:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>d});var r=n(3696);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=o,d=u["".concat(p,".").concat(m)]||u[m]||f[m]||a;return n?r.createElement(d,i(i({ref:t},c),{},{components:n})):r.createElement(d,i({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},674:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>f,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=n(8102),o=(n(3696),n(9916));const a={title:"Exponential backoff",sidebar_position:140},i=void 0,l={unversionedId:"exponential-backoff",id:"exponential-backoff",title:"Exponential backoff",description:"We currently use the formula exp(least(10, attempt)) to determine the delays",source:"@site/docs/exponential-backoff.md",sourceDirName:".",slug:"/exponential-backoff",permalink:"/docs/exponential-backoff",draft:!1,editUrl:"https://github.com/graphile/worker/tree/main/website/docs/exponential-backoff.md",tags:[],version:"current",sidebarPosition:140,frontMatter:{title:"Exponential backoff",sidebar_position:140},sidebar:"tutorialSidebar",previous:{title:"Error handling",permalink:"/docs/error-handling"},next:{title:"Support",permalink:"/docs/support"}},p={},s=[],c={toc:s},u="wrapper";function f(e){let{components:t,...n}=e;return(0,o.yg)(u,(0,r.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"We currently use the formula ",(0,o.yg)("inlineCode",{parentName:"p"},"exp(least(10, attempt))")," to determine the delays\nbetween attempts (the job must fail before the next attempt is scheduled, so the\ntotal time elapsed may be greater depending on how long the job runs for before\nit fails). This seems to handle temporary issues well, after ~4 hours attempts\nwill be made every ~6 hours until the maximum number of attempts is achieved.\nThe specific delays can be seen below:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre"},"select\n  attempt,\n  exp(least(10, attempt)) * interval '1 second' as delay,\n  sum(exp(least(10, attempt)) * interval '1 second') over (order by attempt asc) total_delay\nfrom generate_series(1, 24) as attempt;\n\n attempt |      delay      |   total_delay\n---------+-----------------+-----------------\n       1 | 00:00:02.718282 | 00:00:02.718282\n       2 | 00:00:07.389056 | 00:00:10.107338\n       3 | 00:00:20.085537 | 00:00:30.192875\n       4 | 00:00:54.598150 | 00:01:24.791025\n       5 | 00:02:28.413159 | 00:03:53.204184\n       6 | 00:06:43.428793 | 00:10:36.632977\n       7 | 00:18:16.633158 | 00:28:53.266135\n       8 | 00:49:40.957987 | 01:18:34.224122\n       9 | 02:15:03.083928 | 03:33:37.308050\n      10 | 06:07:06.465795 | 09:40:43.773845\n      11 | 06:07:06.465795 | 15:47:50.239640\n      12 | 06:07:06.465795 | 21:54:56.705435\n      13 | 06:07:06.465795 | 28:02:03.171230\n      14 | 06:07:06.465795 | 34:09:09.637025\n      15 | 06:07:06.465795 | 40:16:16.102820\n      16 | 06:07:06.465795 | 46:23:22.568615\n      17 | 06:07:06.465795 | 52:30:29.034410\n      18 | 06:07:06.465795 | 58:37:35.500205\n      19 | 06:07:06.465795 | 64:44:41.966000\n      20 | 06:07:06.465795 | 70:51:48.431795\n      21 | 06:07:06.465795 | 76:58:54.897590\n      22 | 06:07:06.465795 | 83:06:01.363385\n      23 | 06:07:06.465795 | 89:13:07.829180\n      24 | 06:07:06.465795 | 95:20:14.294975\n")))}f.isMDXComponent=!0}}]);